<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.sist.qna.admin">
  <select id="selectNewQnas" resultType="kr.co.sist.admin.domain.qna.QnaDomain">
  	select qna_num, category, title, content, user_id, input_date
	from qna
	where flag='N'
  </select>
  
  <select id="selectOneNewQna" resultType="kr.co.sist.admin.domain.qna.QnaDomain">
  	select qna_num, category, title, content, user_id, input_date
	from qna
	where qna_num= #{qna_num}
  </select>
  
  <select id="selectOldQnas" resultType="kr.co.sist.admin.domain.qna.QnaDomain">
  	select qna_num, title, input_date
  	from qna 
  	where flag='Y'
  </select>
  
  <select id="selectOneOldQna" resultType="kr.co.sist.admin.domain.qna.QnaDomain">
	select 
	    qna.category,
	    qna.input_date,
	    qna.title,
	    qna.content,
	    qna_answer.ans_title,
	    qna_answer.reply_date,
	    qna_answer.ans_content
	from 
	    qna
	inner join 
	    qna_answer on qna.qna_num = qna_answer.qna_num
	where 
	    qna.qna_num = #{qna_num}
  </select>
  
  <insert id="insertQnaAnswer" parameterType="kr.co.sist.admin.vo.qna.QnaVO">
	insert into qna_answer (user_id, title, content, reply_date)
	select 
		 u.user_id,
		 q.title,
		 #{content},
		 #{reply_date}
	from 
		 users u, 
		 qna q
	where 
		 u.user_id = #{userid}
		 and q.qna_num = #{qnanum};
  </insert>
</mapper>